/*!
CalcNames: The AccName Computation Prototype, compute the Name and Description property values for a DOM node
Returns an object with 'name' and 'desc' properties.
Functionality mirrors the steps within the W3C Accessible Name and Description computation algorithm.
http://www.w3.org/TR/accname-aam-1.1/
Authored by Bryan Garaventa, plus refactoring contrabutions by Tobias Bengfort
https://github.com/whatsock/w3c-alternative-text-computation
Distributed under the terms of the Open Source Initiative OSI - MIT License
*/
!function(){var o=window.AccNamePrototypeNameSpace||window;o&&"string"==typeof o&&o.length&&(window[o]={},o=window[o]),o.getAccNameVersion="2.51",o.getAccName=o.calcNames=function(e,t,ee,r){var te=(r=r||{}).document||document,n={name:"",desc:"",error:""},d=!1,re=!1;try{if(!e||1!==e.nodeType)return n;function o(e,t){var r=t;if(-1!==r.indexOf("attr("))for(var n=r.match(/attr\((.|\n|\r\n)*?\)/g),o=0;o<n.length;o++){var a=n[o].slice(5,-1);a=e.getAttribute(a)||"",r=r.replace(n[o],a)}return r=r.replace(/url\((.*?)\)\s+\/|url\((.*?)\)/g,"").replace(/^\s+|\s+$/g,"").replace(/\"/g,"")}var ne=e,a=Ce(e.getAttribute("role")||""),oe=[],ae=[],ie=function(z,F,J,K,X,Y,Z){(Z=Z||{}).tag=Z.tag||!1,Z.role=Z.role||!1,Z.go=Z.go||!1;var e={name:"",title:""},_=!1,l=function(e,t){for(var r=[];e;){if((e=e.id&&Y[e.id]&&Y[e.id].node&&-1===r.indexOf(e)?(r.push(e),Y[e.id].node):e.parentNode)&&e===t)return!0;if(!e||e===Y.top||e===te.body)return!1}return!1},t={before:"",after:""};Z.tag||Z.role||-1!==oe.indexOf(z)||(t=we(z,null),ee&&(-1===t.before.indexOf(" [ARIA] ")&&-1===t.before.indexOf(" aria-")&&-1===t.before.indexOf(" accName: ")||(t.before=""),-1===t.after.indexOf(" [ARIA] ")&&-1===t.after.indexOf(" aria-")&&-1===t.after.indexOf(" accDescription: ")||(t.after="")));var u=function(e,t,r){var n={name:"",title:""};if(!e)return n;var o=!(!e||1!==e.nodeType||!g(e)),a=e,i=t(e)||{};if(i.name&&i.name.length&&(n.name+=i.name),!i.skip&&!function(e,t){if(!t||!e||1!==t.nodeType||1!==e.nodeType)return!1;function r(e,t){var r=de(e),n=e.nodeName.toLowerCase();return r&&0<=t.roles.indexOf(r)||!r&&0<=t.tags.indexOf(n)}return r(e,c)?e!==t||e.id&&Y[e.id]&&Y[e.id].node?!(l(e,Y.top)&&"select"!==e.nodeName.toLowerCase()||r(t,f)):!fe(e):!(!r(e,s)&&(e!==ne||r(e,f))||Z.go)}(e,Y.top))for(Z.go&&(Z.go=!1),e=e.firstChild;e;)n.name+=u(e,t,r).name,e=e.nextSibling;return n.name+=i.owns||"",ne===a&&r===a&&!Ce(n.name)&&Ce(i.title)?n.name=Ae(i.title):ne===a&&r===a&&Ce(i.title)&&(n.title=Ae(i.title)),ne===a&&r===a&&Ce(i.desc)&&(n.title=Ae(i.desc)),ne===a&&r===a&&Ce(i.placeholder)&&!Ce(n.name)?(n.name=Ae(i.placeholder),d=!0):ne===a&&r===a&&Ce(i.placeholder)&&!Ce(n.title)&&(n.title=Ae(i.placeholder)),(o||i.isWidget)&&(n.name=Ae(n.name)),n};return e=u(z,function(e){var t=0,r=null,n=[],o=[],a={name:"",title:"",owns:"",skip:!1},i=!!(e&&1===e.nodeType&&K&&K.length&&-1!==K.indexOf(e)&&e===ne&&e!==z),l=!1;if((J||!e||xe(e,Y.top))&&!X&&!i)return a;if(Z.tag||Z.role||-1!==oe.indexOf(e))return a;oe.push(e);var u="",d="",f={before:"",after:""},s=z===e?e:e.parentNode;if(Z.tag||Z.role||-1!==oe.indexOf(s)||(oe.push(s),f=we(s,z),ee&&(-1===f.before.indexOf(" [ARIA] ")&&-1===f.before.indexOf(" aria-")&&-1===f.before.indexOf(" accName: ")||(f.before=""),-1===f.after.indexOf(" [ARIA] ")&&-1===f.after.indexOf(" aria-")&&-1===f.after.indexOf(" accDescription: ")||(f.after=""))),1===e.nodeType){var c=e.nodeName.toLowerCase(),g=de(e),p=!Z.tag&&!Z.role&&e.getAttribute("aria-labelledby")||"",m=!Z.tag&&!Z.role&&e.getAttribute("aria-describedby")||"",b=!Z.tag&&!Z.role&&e.getAttribute("aria-description"),h=!Z.tag&&!Z.role&&e.getAttribute("aria-label")||"",x=!Z.tag&&!Z.role&&e.getAttribute("title")||"",v=-1!==se.indexOf(c),y=-1!==["input"].indexOf(c),A=-1!==ce.indexOf(g),w=-1!==ge.indexOf(g),O=-1!==pe.indexOf(g),N=A||w||O||"combobox"===g,C=(N||-1!==me.indexOf(g))&&"link"!==g;a.isWidget=v||C;var S=!1,k=!1,T=e.getAttribute("aria-owns")||"",L=!(Z.tag||Z.role||i||!(e!==z&&(v||N)||e.id&&Y[e.id]&&Y[e.id].target&&Y[e.id].target===e));if(!F&&e===z&&!Z.tag&&!Z.role&&(m||b)){if(m){var V;for(n=m.split(/\s+/),o=[],t=0;t<n.length;t++)r=te.getElementById(n[t]),o.push(ie(r,!0,!1,[e],!1,{ref:Y,top:r}).name);V=Ce(o.join(" "))}else V=Ce(b);Ce(V)&&(a.desc=V,k=!0)}if(!F&&!Z.tag&&!Z.role&&p){for(n=p.split(/\s+/),o=[],t=0;t<n.length;t++)r=te.getElementById(n[t]),o.push(ie(r,!0,J,[e],r===z,{ref:Y,top:r}).name);u=Ce(o.join(" ")),Ce(u)&&(_=l=S=!0,a.skip=!0)}Z.tag||Z.role||S||!Ce(h)||L||Ce(u=h)&&(l=S=!0,e===z&&(_=J=!0));var j=!Z.tag&&!Z.role&&!S&&"iframe"!==c&&g&&-1!==be.indexOf(g)&&!fe(e)&&!he(e);if(!L){if(!Z.tag&&!Z.role&&!S&&e===z&&v){var q=te.querySelectorAll("label"),I="",P=Oe(e,"label")||!1;for(t=0;t<q.length;t++)(q[t]!==P||"string"==typeof P.getAttribute("for"))&&q[t].getAttribute("for")!==e.id||ve(q[t],te.body,!0)||(I+=Ae(ie(q[t],!0,J,[e],!1,{ref:Y,top:q[t]}).name));Ce(u=I)&&(S=!0)}var R=!Z.tag&&!Z.role&&y&&(e.getAttribute("type")||"").toLowerCase()||!1,E=!Z.tag&&!Z.role&&R&&Ce(e.getAttribute("value"))||!1,B=j&&"img"===c?"":Ce(e.alt||e.getAttribute("alt"));if(Z.tag||Z.role||S||j||"img"!==c&&"image"!==R||!B&&!Ce(x)||(u=Ce(B)||Ce(x),Ce(u)&&(S=!0)),Z.tag||Z.role||S||j||"area"!==c||!B||(u=Ce(B),Ce(u)&&(S=!0)),"optgroup"===c&&(Z.tag||Z.role||S||j||!e.getAttribute("label")||(u=Ce(e.getAttribute("label")),Ce(u)&&(S=!0)),a.skip=!0),!Z.tag&&!Z.role&&!S&&e===z&&R&&-1!==["button","submit","reset"].indexOf(R)){if(E)u=E;else switch(R){case"submit":u="submit";break;case"reset":u="reset";break;default:u=""}Ce(u)&&(S=!0)}if(!Z.tag&&!Z.role&&S&&e===z&&R&&-1!==["button","submit","reset"].indexOf(R)&&E&&E!==u&&!a.desc&&(a.desc=E,k=!0),Z.tag||Z.role||S||e!==z||!R||"image"!==R||(u="Submit Query",re=S=!0),!(Z.tag||Z.role||S||e!==ne||"group"!==g&&"radiogroup"!==g&&(g||"fieldset"!==c))){var D=le(e,["legend"],["legend"])||!1;D&&(u=Ce(ie(D,F,!1,[],!1,{ref:Y,top:D}).name)),Ce(u)&&(S=!0),J=!0}if(Z.tag||Z.role||S||e!==ne||"table"!==g&&(g||"table"!==c)||((D=le(e,["caption"],["caption"])||!1)&&(u=Ce(ie(D,F,!1,[],!1,{ref:Y,top:D}).name)),Ce(u)&&(S=!0),J=!0),Z.tag||Z.role||S||e!==ne||"figure"!==g&&(g||"figure"!==c)||((D=le(e,["figcaption"],["caption"])||ue(e,["figcaption"],["caption"])||!1)&&(u=Ce(ie(D,F,!1,[],!1,{ref:Y,top:D}).name)),Ce(u)&&(S=!0),J=!0),!Z.tag&&!Z.role&&"svg"===c){var H=e.querySelector("title")||!1,$=e===ne&&e.querySelector("desc")||!1;if(!S&&H&&(u=Ce(ie(H,!0,!1,[],!1,{ref:Y,top:H}).name)),!k&&$){var M=Ce(ie($,!0,!1,[],!1,{ref:Y,top:$}).name);Ce(M)&&(a.desc=M)}a.skip=!0}}Z.tag||Z.role||!L||K&&K.length&&-1!==K.indexOf(e)||(A?u=ye(g,e,!0):w||"combobox"===g&&v?u=ye(g,e,!1,!0):O?u=ye(g,e,!1,!1,!0):!v||-1===["input","textarea"].indexOf(c)||C&&!w?!v||"select"!==c||C&&"combobox"!==g||(u=ye(g,e,!1,!1,!0,!0)):u=ye(g,e,!1,!1,!1,!0),u=Ce(u)),Z.tag||Z.role||j||!Ce(x)||u&&" "===b||(a.title=Ce(x));var W=v&&Ce(e.getAttribute("type")||"").toLowerCase();W=W||"text";var G=!Z.tag&&!Z.role&&e===ne&&e===z&&(w||v&&("textarea"===c||"input"===c&&-1!==["password","search","tel","text","url","email"].indexOf(W)))&&Ce(e.getAttribute("placeholder")||e.getAttribute("aria-placeholder"));G&&(a.placeholder=G);var Q=Z.role&&Z.role===g||!g&&Z.tag&&Z.tag===c;if(Q&&(u=Ce(ie(e,F,!1,[],!1,{ref:Y,top:e}).name),Ce(u)&&(J=!0)),!Q&&T&&-1===["input","img","progress"].indexOf(c)){for(n=T.split(/\s+/),o=[],t=0;t<n.length;t++)if((r=te.getElementById(n[t]))&&-1===ae.indexOf(n[t])){ae.push(n[t]);var U={ref:Y,top:Y.top};U[n[t]]={refNode:z,node:e,target:r},ve(r,te.body,!0)||o.push(ie(r,!0,J,[],!1,U).name)}d=o.join("")}}else Z.tag||Z.role||3!==e.nodeType||(u=e.data);return l||(u=f.before+u.replace(/\s+/g," ")+f.after),u.length&&!Ne(e,Y.top,Y)&&(a.name=u),a.owns=d,a},z),_||(e.name=t.before+e.name.replace(/\s+/g," ")+t.after),e},le=function(e,t,r,n){for(e=e?e.firstChild:null;e;){var o=de(e)||!1;if(1===e.nodeType&&(!t&&!r||o&&r&&-1!==r.indexOf(o)||!o&&t&&-1!==t.indexOf(e.nodeName.toLowerCase())))return e;if(!n&&1===e.nodeType&&(t||r))return null;e=e.nextSibling}return e},ue=function(e,t,r,n){for(e=e?e.lastChild:null;e;){var o=de(e)||!1;if(1===e.nodeType&&(!t&&!r||o&&r&&-1!==r.indexOf(o)||!o&&t&&-1!==t.indexOf(e.nodeName.toLowerCase())))return e;if(!n&&1===e.nodeType&&(t||r))return null;e=e.previousSibling}return e},de=function(e){var t=e&&e.getAttribute?(e.getAttribute("role")||"").toLowerCase():"";if(!Ce(t))return"";function r(e){return 0<Ce(t).length&&0<=e.roles.indexOf(t)}for(var n=t.split(/\s+/),o=0;o<n.length;o++)if(t=n[o],r(f)||r(s)||r(c)||r(i)||-1!==be.indexOf(t))return t;return""},fe=function(e){var t=e.nodeName.toLowerCase();return!!e.getAttribute("tabindex")||(!("a"!==t||!e.getAttribute("href"))||-1!==["button","input","select","textarea"].indexOf(t)&&"hidden"!==(e.getAttribute("type")||"").toLowerCase())},f={roles:["button","checkbox","link","option","radio","switch","tab","treeitem","menuitem","menuitemcheckbox","menuitemradio","row","cell","gridcell","columnheader","rowheader","tooltip","heading"],tags:["a","button","summary","input","h1","h2","h3","h4","h5","h6","menuitem","option","tr","td","th"]},s={roles:["application","alert","log","marquee","timer","alertdialog","dialog","banner","complementary","form","main","navigation","region","search","article","document","feed","figure","img","math","toolbar","menu","menubar","grid","listbox","radiogroup","textbox","searchbox","spinbutton","scrollbar","slider","tablist","tabpanel","tree","treegrid","separator","rowgroup","group"],tags:["article","aside","body","select","datalist","optgroup","dialog","figure","footer","form","header","hr","iframe","img","textarea","input","main","math","menu","nav","section","thead","tbody","tfoot","fieldset"]},c={roles:["term","definition","directory","list","note","status","table","contentinfo"],tags:["dl","ul","ol","dd","details","output","table"]},i={roles:["legend","caption"],tags:["legend","caption","figcaption"]},se=["button","input","select","textarea"],ce=["scrollbar","slider","spinbutton"],ge=["searchbox","textbox"],pe=["grid","listbox","tablist","tree","treegrid"],me=["button","checkbox","link","switch","option","menu","menubar","menuitem","menuitemcheckbox","menuitemradio","radio","tab","treeitem","gridcell"],be=["presentation","none"],he=function(e){for(var t=["labelledby","label","describedby","busy","controls","current","details","disabled","dropeffect","errormessage","flowto","grabbed","haspopup","invalid","keyshortcuts","live","owns","roledescription"],r=0;r<t.length;r++){if(Ce(e.getAttribute("aria-"+t[r])))return!0}return!1},xe=r.isHidden||function(e,r){return function(e){if(!e||1!==e.nodeType||e===r)return!1;if("true"===e.getAttribute("aria-hidden"))return!0;if(e.getAttribute("hidden"))return!0;var t=l(e);return"none"===t.display||"hidden"===t.visibility}(e)},ve=function(e,t,r,n){for(;e&&e!==t;){if(!n&&1===e.nodeType&&xe(e,t))return!0;n=!1,e=e.parentNode}return!1},l=r.getStyleObject||function(e){var t={};return te.defaultView&&te.defaultView.getComputedStyle?t=te.defaultView.getComputedStyle(e,""):e.currentStyle&&(t=e.currentStyle),t},g=function(e,t){var r=t||l(e);for(var n in u)for(var o=u[n],a=0;a<o.length;a++)if(r[n]&&(0===o[a].indexOf("!")&&-1===[o[a].slice(1),"inherit","initial","unset"].indexOf(r[n])||0===r[n].indexOf(o[a])))return!0;return!t&&e.nodeName&&-1!==p.indexOf(e.nodeName.toLowerCase())&&!(r.display&&0===r.display.indexOf("inline")&&"br"!==e.nodeName.toLowerCase())},u={display:["block","grid","table","flow-root","flex"],position:["absolute","fixed"],float:["left","right","inline"],clear:["left","right","both","inline"],overflow:["hidden","scroll","auto"],"column-count":["!auto"],"column-width":["!auto"],"column-span":["all"],contain:["layout","content","strict"]},p=["address","article","aside","blockquote","br","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","legend","li","main","nav","noscript","ol","output","p","pre","section","table","td","tfoot","th","tr","ul","video"],ye=function(e,t,r,n,o,a){var i="",l=!1;if(r&&!a)i=t.getAttribute("aria-valuetext")||t.getAttribute("aria-valuenow")||"";else if(n&&!a)i=h(t)||"";else if(o&&!a){var u=[];"grid"===e||"treegrid"===e?u=["gridcell","rowheader","columnheader"]:"listbox"===e?u=["option"]:"tablist"===e?u=["tab"]:"tree"===e&&(u=["treeitem"]),i=m(t,t.querySelectorAll('*[aria-selected="true"]'),!1,u),l=!0}return!(i=Ce(i))&&(r||n)&&t.value&&(i=t.value),l||i||!a||(i=o?m(t,t.querySelectorAll("option[selected]"),!0):t.value),i},Ae=function(e){return Ce(e).length?" "+e+" ":" "},m=function(e,t,r,n){if(!t||!t.length)return"";for(var o=[],a=0;a<t.length;a++){var i=de(t[a]);(!n||-1!==n.indexOf(i))&&o.push(r?h(t[a]):ie(t[a],!0,!1,[],!1,{top:t[a]}).name)}return o.join(" ")},b=r.getPseudoElStyleObj||function(e,t){var r={};for(var n in u)r[n]=te.defaultView.getComputedStyle(e,t).getPropertyValue(n);return r.content=te.defaultView.getComputedStyle(e,t).getPropertyValue("content").replace(/^"|\\|"$/g,""),r},h=function(e,t){if(!t&&1===e.nodeType)return e.innerText||e.textContent||"";var r=b(e,t),n=r.content;return n&&"none"!==n?(g({},r)&&(":before"===t?n+=" ":":after"===t&&(n=" "+n)),n):""},we=r.getCSSText||function(e,t){return e&&1!==e.nodeType||e===t||-1!==["input","select","textarea","img","iframe","optgroup"].indexOf(e.nodeName.toLowerCase())?{before:"",after:""}:{before:o(e,h(e,":before")),after:o(e,h(e,":after"))}},Oe=function(e,t,r,n){for(n=!!n;e;)if((e=e.parentNode)&&(r&&de(e)===r||t&&e.nodeName&&e.nodeName.toLowerCase()===t&&(!n||de(e).length<1)))return e;return{}},Ne=function(e,t,r,n){for(var o=[];e&&e!==t;)if((e=e.id&&r&&r[e.id]&&r[e.id].node&&-1===o.indexOf(e)?(o.push(e),r[e.id].node):e.parentNode)&&e.getAttribute&&(Ce(e.getAttribute("aria-label"))||!n&&xe(e,t)))return!0;return!1};if(ve(e,te.body,!0,!(!e||!e.nodeName||"area"!==e.nodeName.toLowerCase())))return n;var x=ie(e,!1,!1,[],!1,{top:e}),v=Ce(x.name.replace(/\s+/g," ")),y=Ce(x.title.replace(/\s+/g," "));v===y&&(y=""),n.hasUpperCase=!(!a||a===a.toLowerCase()),n.name=v,n.desc=y,oe=[],ae=[]}catch(e){n.error=e}return n.placeholder=d,n.userAgent=re,t&&"function"==typeof t?t.apply(e,[n,e]):n};var Ce=function(e){return"string"!=typeof e?"":e.replace(/^\s+|\s+$/g,"")};o.getAccNameMsg=o.getNames=function(e,t){var r=o.getAccName(e,null,!1,t);if(r.error)return r.error+"\n\nAn error has been thrown in AccName Prototype version "+o.getAccNameVersion+". Please copy this error message and the HTML markup that caused it, and submit both as a new GitHub issue at\nhttps://github.com/whatsock/w3c-alternative-text-computation";var n='accName: "'+r.name+'"\n\naccDesc: "'+r.desc+'"\n\n';return r.placeholder&&(n+="Name from placeholder: true\n\n"),r.userAgent&&(n+="Name from user agent: true\n\n"),n+="(Running AccName Computation Prototype version: "+o.getAccNameVersion+")"},"object"==typeof module&&module.exports&&(module.exports={getNames:o.getNames,calcNames:o.calcNames})}();